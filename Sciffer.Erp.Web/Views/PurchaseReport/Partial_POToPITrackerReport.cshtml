
@using Sciffer.Erp.Domain.ViewModel
@{(Html.EJ().Grid<purchase_order_report_vm>("Editing")
            .Datasource(ds => ds.URL(Url.Action("Get_Purchase_Order_Report", "PurchaseReport") + "?entity=" + ViewBag.entity + "&from_date=" + ViewBag.from_date + "&to_date=" + ViewBag.to_date).Adaptor(AdaptorType.UrlAdaptor))
                .AllowPaging().PageSettings(a => a.PageSize(20))
                .AllowFiltering()
                    .FilterSettings(X => X.FilterType(FilterType.Excel))
                .ShowColumnChooser()
                .AllowSorting()
                .AllowScrolling()
                .Mappers(map => map.ExportToExcelAction(Url.Action("ExportToExcel", "PurchaseReport", new { ctrlname = "POToPITrackerReport" })))
                .ScrollSettings(scroll => { scroll.Width("100%"); })

            .ToolbarSettings(toolbar =>
            {
                toolbar.ShowToolbar().ToolbarItems(items =>
                {
                    items.AddTool(ToolBarItems.Search);
                    items.AddTool(ToolBarItems.ExcelExport);
                    items.AddTool(ToolBarItems.PrintGrid);
                });
            })
        .Columns(col =>
        {
            col.Field("vendor_code").Width("15%").HeaderText("Vendor Code").Add();
            col.Field("vendor_name").Width("15%").HeaderText("vendor Description").Add();
            col.Field("category").Width("15%").HeaderText("Doc Category").Add();
            col.Field("vendor_doc_no").Width("15%").HeaderText("Vendor Document No").Add();
            col.Field("vendor_doc_date").Width("15%").Format("{0:dd/MM/yyyy}").HeaderText("Vendor Document Date").Add();
            col.Field("pr_no").Width("15%").HeaderText("PR Number").Add();
            col.Field("pur_requisition_date").Width("15%").Format("{0:dd/MM/yyyy}").HeaderText("PR Date").Add();
            col.Field("po_no").Width("15%").HeaderText("PO Number").Add();
            col.Field("po_date").Width("15%").Format("{0:dd/MMM/yyyy}").HeaderText("PO Date").Add();
            col.Field("item_code").Width("15%").HeaderText("Item Code").Add();
            col.Field("item_name").Width("15%").HeaderText("Item Description").Add();
            col.Field("delivery_date").Width("15%").Format("{0:dd/MMM/yyyy}").HeaderText("Delivery Date").Add();
            col.Field("quantity").Width("15%").HeaderText("Qty").Format("{0:n2}").TextAlign(TextAlign.Right).Add();
            col.Field("po_net_value").Width("15%").HeaderText("PO Net Value").Format("{0:n2}").TextAlign(TextAlign.Right).Add();
            col.Field("grn_category").Width("15%").HeaderText("GRN Category").Add();
            col.Field("grn_number").Width("15%").HeaderText("GRN Number").Add();
            col.Field("grn_date").Width("15%").Format("{0:dd/MMM/yyyy}").HeaderText("GRN Date").Add();
            col.Field("gate_entry_number").Width("15%").HeaderText("Gate entry Number").Add();
            col.Field("gate_entry_date").Width("15%").Format("{0:dd/MM/yyyy}").HeaderText("Gate Entry Date").Add();
            col.Field("grn_quantity").Width("15%").HeaderText("GRN Qty").Format("{0:n2}").TextAlign(TextAlign.Right).Add();
            col.Field("grn_net_value").Width("15%").HeaderText("GRN Net Value").Format("{0:n2}").TextAlign(TextAlign.Right).Add();
            col.Field("iex_category").Width("15%").HeaderText("IEX Category").Add();
            col.Field("incoming_excise_number").Width("15%").HeaderText("IEX Number").Add();
            col.Field("incoming_excise_posting_date").Width("15%").Format("{0:dd/MMM/yyyy}").HeaderText("IEX Posting Date").Add();
            col.Field("iex_quantity").Width("15%").HeaderText("IEX Qty").Format("{0:n2}").TextAlign(TextAlign.Right).Add();
            col.Field("iex_net_vlue").Width("15%").HeaderText("IEX Net Value").Format("{0:n2}").TextAlign(TextAlign.Right).Add();
            col.Field("iex_category").Width("15%").HeaderText("IEX Category").Add();
            col.Field("pi_category").Width("15%").HeaderText("PI Category").Add();
            col.Field("pi_number").Width("15%").HeaderText("PI Number").Add();
            col.Field("pi_date").Width("15%").Format("{0:dd/MM/yyyy}").HeaderText("PI Date").Add();
            col.Field("pi_quantity").Width("15%").HeaderText("PI Qty").Format("{0:n2}").TextAlign(TextAlign.Right).Add();
            col.Field("pi_net_value").Width("15%").HeaderText("PI Net Value").Format("{0:n2}").TextAlign(TextAlign.Right).Add();
        })
              .ClientSideEvents(eve => { eve.ToolbarClick("OnToolbarClickp"); })
               ).Render();}
@Html.EJ().ScriptManager()



