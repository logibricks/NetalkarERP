@using Sciffer.Erp.Domain.ViewModel
@using Syncfusion.JavaScript.Models
@{(Html.EJ().Grid<purchase_order_report_vm>("Editing")
                        .Datasource(ds => ds.URL(Url.Action("Get_Purchase_Order_Report", "PurchaseReport") + "?entity=" + ViewBag.entity + "&from_date=" + ViewBag.from_date + "&to_date=" + ViewBag.to_date + "&created_by=" + ViewBag.created_by + "&plant_id=" + ViewBag.plant_id  + "&item_category=" + ViewBag.item_category + "&source_id=" + ViewBag.source_id).Adaptor(AdaptorType.UrlAdaptor))
                        .AllowPaging().PageSettings(a => a.PageSize(20))
                        .AllowFiltering()
                            .FilterSettings(X => X.FilterType(FilterType.Excel))
                        .ShowColumnChooser()
                        .AllowSorting()
                        .AllowScrolling()
                            .Mappers(map => map.ExportToExcelAction(Url.Action("ExportToExcel", "PurchaseReport", new { ctrlname = "PRDetailed" })))
                        .ScrollSettings(scroll => { scroll.Width("100%"); })
                    .ToolbarSettings(toolbar =>
                    {
                        toolbar.ShowToolbar().ToolbarItems(items =>
                        {
                            items.AddTool(ToolBarItems.Search);
                            items.AddTool(ToolBarItems.ExcelExport);
                            items.AddTool(ToolBarItems.PrintGrid);
                        });
                    })
            .Columns(col =>
            {
                col.Field("pr_doc_category").Width("10%").HeaderText("Doc Category").Add();
                col.Field("pur_requisition_number").Width("10%").HeaderText("Document Number").Add();
                col.Field("pur_requisition_date").Width("10%").HeaderText("PR Doc Date").Format("{0:dd/MMM/yyyy}").Visible(true).Add();
                col.Field("business_unit_name").Width("10%").HeaderText("Business Unit").Visible(true).Add();
                col.Field("plant_name").Width("10%").HeaderText("Plant").Visible(true).Add();
                col.Field("header_delivery_date").Width("10%").HeaderText("Header Delivery Date").Format("{0:dd/MMM/yyyy}").Visible(true).Add();
                col.Field("source_name").Width("10%").HeaderText("Source").Visible(true).Add();
                col.Field("item_code").Width("10%").HeaderText("Item Code").Visible(true).Add();
                // col.Field("Item_Description").Width("10%").HeaderText("Item Description").Visible(true).Add();
                col.Field("delivery_date").Width("10%").HeaderText("Delivery Date").Format("{0:dd/MMM/yyyy}").Visible(true).Add();
                col.Field("quantity").Width("10%").HeaderText("Qty").TextAlign(TextAlign.Right).Visible(false).Add();
                col.Field("uom_name").Width("10%").HeaderText("UoM").Visible(false).Add();
                col.Field("storage_location_name").Width("10%").HeaderText("SLOC").Visible(false).Add();
                col.Field("info_price").Width("10%").HeaderText("Info Price").TextAlign(TextAlign.Right).Visible(false).Add();
                col.Field("vendor_name").Width("10%").HeaderText("Preferred Vendor").Visible(true).Add();
            })
            .ClientSideEvents(eve => { eve.ToolbarClick("OnToolbarClickp"); })
                ).Render();}
@Html.EJ().ScriptManager()



